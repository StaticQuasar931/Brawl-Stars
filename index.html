<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

  <!-- Primary SEO -->
  <title>Brawl Stars – Play Free | StaticQuasar931 Unblocked Games</title>
  <meta name="description" content="Play Brawl Stars free on StaticQuasar931 Unblocked Games. Fast WebGL build, instant loading, working audio, and smooth gameplay."/>
  <meta name="keywords" content="Brawl Stars, unblocked games, webgl, play online, free game, shooter, action, StaticQuasar931"/>
  <link rel="canonical" href="https://staticquasar931.github.io/Brawl-Stars/"/>

  <!-- Open Graph -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Brawl Stars – Play Free | StaticQuasar931 Unblocked Games"/>
  <meta property="og:description" content="Play Brawl Stars free on StaticQuasar931 Unblocked Games."/>
  <meta property="og:url" content="https://staticquasar931.github.io/Brawl-Stars/"/>
  <meta property="og:image" content="https://cdn.jsdelivr.net/gh/StaticQuasar931/Images@main/StaticQuasar931_Banner_Media_Google_Sites_Neon_ChatGPT_Image.png"/>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Brawl Stars – Play Free | StaticQuasar931 Unblocked Games"/>
  <meta name="twitter:description" content="Play Brawl Stars free on StaticQuasar931 Unblocked Games."/>
  <meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/StaticQuasar931/Images@main/StaticQuasar931_Banner_Media_Google_Sites_Neon_ChatGPT_Image.png"/>

  <!-- PWA and visual polish -->
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes"/>
  <meta name="theme-color" content="#242424"/>
  <link rel="icon" href="icon.png" type="image/png"/>
  <link rel="apple-touch-icon" href="icon.png"/>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "VideoGame",
    "name": "Brawl Stars",
    "url": "https://staticquasar931.github.io/Brawl-Stars/",
    "image": "https://cdn.jsdelivr.net/gh/StaticQuasar931/Images@main/StaticQuasar931_Banner_Media_Google_Sites_Neon_ChatGPT_Image.png",
    "genre": "Action",
    "applicationCategory": "Game",
    "operatingSystem": "Web",
    "author": {
      "@type": "Organization",
      "name": "StaticQuasar931 Unblocked Games"
    },
    "publisher": {
      "@type": "Organization",
      "name": "StaticQuasar931 Unblocked Games"
    }
  }
  </script>

  <!-- Performance hints -->
  <link rel="preload" as="script" href="Build/web.loader.js"/>
  <link rel="preload" as="fetch" href="Build/web.framework.js.unityweb" crossorigin/>
  <link rel="preload" as="fetch" href="Build/web.wasm.unityweb" crossorigin/>
  <link rel="preload" as="fetch" href="Build/web.data.unityweb" crossorigin/>

  <style>
    html, body { width:100%; height:100%; padding:0; margin:0; background:#242424; }
    .fullscreen { width:100%; height:100%; position:absolute; top:0; left:0; }
    #canvas { background:#242424; display:block; }

    /* Loading overlay with visual SEO text and linked banner */
    #loading-overlay {
      font-size:20px; z-index:3; display:flex; flex-direction:column;
      justify-content:center; align-items:center; color:#fff; text-align:center;
      padding:16px;
    }
    #loading-title {
      margin-bottom:10px; font-weight:600; letter-spacing:.3px;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    #icon { max-width:300px; border-radius:10px; margin:8px 0 16px 0; }
    #promo-link { display:inline-block; margin:10px 0 18px 0; }
    #promo-link img { max-width:720px; width:90vw; height:auto; border-radius:8px; }

    #progress-bar { border-radius:5px; width:90%; max-width:280px; height:20px; background:#181818; padding:5px; }
    #progress-bar-fill { border-radius:3px; width:0%; height:100%; background:#9747FF; transition:width .2s linear; }

    /* Banner container hidden */
    #banner-container { position:absolute; bottom:0; width:100%; height:90px; display:none !important; }

    /* Static menu top left, down about 100px */
    #static-menu {
      position:absolute; top:100px; left:16px; z-index:4;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#fff;
      background:rgba(0,0,0,.35);
      backdrop-filter: blur(4px);
      border-radius:10px;
      padding:10px 12px;
      box-shadow:0 6px 16px rgba(0,0,0,.35);
    }
    #static-menu a, #static-menu button {
      display:block; margin:6px 0; padding:8px 10px; font-size:14px;
      color:#fff; background:rgba(151,71,255,.25); border:1px solid rgba(151,71,255,.55);
      border-radius:8px; cursor:pointer; text-decoration:none;
    }
    #static-menu a:hover, #static-menu button:hover { background:rgba(151,71,255,.4); }

    /* Animations container bottom right, 70px higher than normal */
    #animations-container {
      position:absolute; right:20px; bottom:70px; z-index:4; pointer-events:none;
    }

    /* Tap to start prompt for audio gesture */
    #tap-to-start {
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      color:#fff; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:rgba(0,0,0,.35); cursor:pointer; user-select:none;
      opacity:0; pointer-events:none; transition:opacity .2s ease; z-index:5;
    }
    #tap-to-start.visible { opacity:1; pointer-events:auto; }
    #tap-to-start .bubble {
      background:#111; padding:14px 18px; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,.4);
    }

    /* Visual SEO: semantic heading off-canvas for screen readers and bots */
    h1#seo-title {
      position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden;
    }
  </style>
</head>
<body>
  <!-- Visual SEO heading -->
  <h1 id="seo-title">Brawl Stars on StaticQuasar931 Unblocked Games</h1>

  <!-- Unity canvas -->
  <canvas id="canvas" class="fullscreen" aria-label="Brawl Stars game canvas"></canvas>

  <!-- Optional ad banner holder (hidden) -->
  <div id="banner-container"></div>

  <!-- Loading overlay -->
  <div id="loading-overlay" class="fullscreen" role="status" aria-live="polite">
    <div id="loading-title">StaticQuasar931 Unblocked Games presents</div>
    <img id="icon" src="./icon.png" alt="Brawl Stars icon"/>
    <a id="promo-link" href="https://sites.google.com/view/staticquasar931/gm3z" target="_blank" rel="noopener">
      <img src="https://cdn.jsdelivr.net/gh/StaticQuasar931/Images@main/StaticQuasar931_Banner_Media_Google_Sites_Neon_ChatGPT_Image.png"
           alt="Visit StaticQuasar931 Unblocked Games"/>
    </a>
    <div id="progress-bar" aria-label="Loading progress"><div id="progress-bar-fill"></div></div>
  </div>

  <!-- Static menu in top left -->
  <nav id="static-menu" aria-label="Game menu">
    <button type="button" onclick="HowlerSoundOn()">Sound On</button>
    <button type="button" onclick="HowlerSoundOff()">Sound Off</button>
    <a href="https://sites.google.com/view/staticquasar931/gm3z" target="_blank" rel="noopener">More Games</a>
  </nav>

  <!-- Animations container bottom right, 70px higher -->
  <div id="animations-container" aria-hidden="true">
    <!-- Drop decorative DOM animations here if desired -->
  </div>

  <!-- Tap to start prompt for audio -->
  <div id="tap-to-start"><div class="bubble">Tap or click to enable audio</div></div>

  <!-- Local libraries -->
  <script src="add/howler.js"></script>
  <script src="add/mo.js"></script>

  <script>
    // DOM refs
    const canvas = document.getElementById('canvas');
    const loadingOverlay = document.getElementById('loading-overlay');
    const progressBarFill = document.getElementById('progress-bar-fill');
    const tapToStart = document.getElementById('tap-to-start');

    // Globals used by Unity glue
    window.unityInstance = null;
    window.sounds = {};
    window.sound = null;
    window.isSound = 1;

    // Progress UI
    let progressBarFillingInterval = null;
    let progressBarCompleteFillingStarted = false;

    function onUnityLoadingProgressChanged(progress) {
      if (progress >= 1 && progressBarFillingInterval !== null) {
        clearInterval(progressBarFillingInterval);
        progressBarFillingInterval = null;
        return;
      }
      if (progressBarCompleteFillingStarted) return;
      if (progress >= 0.9) {
        progressBarCompleteFillingStarted = true;
        completeProgressBarFilling();
        return;
      }
      progressBarFill.style.width = (progress * 100) + '%';
    }

    function completeProgressBarFilling() {
      if (progressBarFillingInterval !== null) return;
      let currentPercent = 90;
      progressBarFill.style.width = currentPercent + '%';
      progressBarFillingInterval = setInterval(() => {
        currentPercent++;
        if (currentPercent > 100) currentPercent = 100;
        progressBarFill.style.width = currentPercent + '%';
        if (currentPercent >= 100) {
          clearInterval(progressBarFillingInterval);
          progressBarFillingInterval = null;
        }
      }, 100);
    }

    // Focus helpers
    window.addEventListener('pointerdown', () => { window.focus(); canvas.focus(); });

    // Unity message helper
    function sendMessageToUnity(name, value) {
      if (window.unityInstance && typeof window.unityInstance.SendMessage === 'function') {
        window.unityInstance.SendMessage('PlaygamaBridge', name, value || '');
      }
    }

    // Bridge stubs Unity expects
    const asBool = v => v ? 'true' : 'false';

    window.getPlatformId = () => '';
    window.getPlatformLanguage = () => 'en';
    window.getPlatformPayload = () => '';
    window.getPlatformTld = () => '';
    window.sendMessageToPlatform = () => {};
    window.getServerTime = () => sendMessageToUnity('OnGetServerTimeCompleted', Date.now().toString());

    window.getDeviceType = () => 'desktop';

    window.getIsPlayerAuthorizationSupported = () => asBool(false);
    window.getIsPlayerAuthorized = () => asBool(false);
    window.getPlayerId = () => '';
    window.getPlayerName = () => '';
    window.getPlayerPhotos = () => '[]';
    window.authorizePlayer = () => sendMessageToUnity('OnAuthorizeCompleted', asBool(false));

    window.getVisibilityState = () => 'visible';

    window.getStorageDefaultType = () => 'local';
    window.getIsStorageSupported = () => asBool(true);
    window.getIsStorageAvailable = () => asBool(true);
    window.getStorageData = (key) => sendMessageToUnity('OnGetStorageDataSuccess', `${key}{bridge_data_separator}`);
    window.setStorageData = (key) => sendMessageToUnity('OnSetStorageDataSuccess', key);
    window.deleteStorageData = (key) => sendMessageToUnity('OnDeleteStorageDataSuccess', key);

    window.getInterstitialState = () => '';
    window.getIsBannerSupported = () => asBool(false);
    window.getMinimumDelayBetweenInterstitial = () => '0';
    window.setMinimumDelayBetweenInterstitial = () => {};
    window.showBanner = () => {};
    window.hideBanner = () => {};
    window.showInterstitial = () => {};
    window.showRewarded = () => {};
    window.checkAdBlock = () => sendMessageToUnity('OnCheckAdBlockCompleted', asBool(false));

    window.getIsShareSupported = () => asBool(false);
    window.getIsInviteFriendsSupported = () => asBool(false);
    window.getIsJoinCommunitySupported = () => asBool(false);
    window.getIsCreatePostSupported = () => asBool(false);
    window.getIsAddToHomeScreenSupported = () => asBool(false);
    window.getIsAddToFavoritesSupported = () => asBool(false);
    window.getIsRateSupported = () => asBool(false);
    window.getIsExternalLinksAllowed = () => asBool(true);
    window.share = () => sendMessageToUnity('OnShareCompleted', asBool(false));
    window.inviteFriends = () => sendMessageToUnity('OnInviteFriendsCompleted', asBool(false));
    window.joinCommunity = () => sendMessageToUnity('OnJoinCommunityCompleted', asBool(false));
    window.createPost = () => sendMessageToUnity('OnCreatePostCompleted', asBool(false));
    window.addToHomeScreen = () => sendMessageToUnity('OnAddToHomeScreenCompleted', asBool(false));
    window.addToFavorites = () => sendMessageToUnity('OnAddToFavoritesCompleted', asBool(false));
    window.rate = () => sendMessageToUnity('OnRateCompleted', asBool(false));

    window.getIsLeaderboardSupported = () => asBool(false);
    window.getIsLeaderboardNativePopupSupported = () => asBool(false);
    window.getIsLeaderboardSetScoreSupported = () => asBool(false);
    window.getIsLeaderboardGetScoreSupported = () => asBool(false);
    window.getIsLeaderboardGetEntriesSupported = () => asBool(false);
    window.leaderboardSetScore = () => sendMessageToUnity('OnLeaderboardSetScoreCompleted', asBool(false));
    window.leaderboardGetScore = () => sendMessageToUnity('OnLeaderboardGetScoreCompleted', '');
    window.leaderboardGetEntries = () => sendMessageToUnity('OnLeaderboardGetEntriesCompletedSuccess', '[]');
    window.leaderboardShowNativePopup = () => sendMessageToUnity('OnLeaderboardShowNativePopupCompleted', asBool(false));

    window.getIsPaymentsSupported = () => asBool(false);
    window.getIsCatalogSupported = () => asBool(false);
    window.getIsPurchaseListSupported = () => asBool(false);
    window.getIsPurchaseConsumingSupported = () => asBool(false);
    window.paymentsPurchase = () => sendMessageToUnity('OnPaymentsPurchaseFailed', '');
    window.paymentsConsumePurchase = () => sendMessageToUnity('OnPaymentsConsumePurchaseCompleted', asBool(false));
    window.paymentsGetCatalog = () => sendMessageToUnity('OnPaymentsGetCatalogCompletedSuccess', '[]');
    window.paymentsGetPurchases = () => sendMessageToUnity('OnPaymentsGetPurchasesCompletedSuccess', '[]');

    window.getIsRemoteConfigSupported = () => asBool(false);
    window.remoteConfigGet = () => sendMessageToUnity('OnRemoteConfigGetFailed', '');

    window.getIsAchievementsSupported = () => asBool(false);
    window.getIsGetAchievementsListSupported = () => asBool(false);
    window.getIsAchievementsNativePopupSupported = () => asBool(false);
    window.achievementsUnlock = () => sendMessageToUnity('OnAchievementsUnlockCompleted', asBool(false));
    window.achievementsShowNativePopup = () => sendMessageToUnity('OnAchievementsShowNativePopupCompleted', asBool(false));
    window.achievementsGetList = () => sendMessageToUnity('OnAchievementsGetListCompletedSuccess', '[]');

    // Howler and audio integration
    function ensureHowlerReady() {
      return new Promise((resolve) => {
        const start = Date.now();
        (function waitForHowl() {
          if (typeof window.Howl === 'function') return resolve(true);
          if (Date.now() - start > 3000) return resolve(false);
          setTimeout(waitForHowl, 25);
        })();
      });
    }

    let primedLoop = null;
    function primeAudio() {
      try {
        primedLoop = new Howl({ src:['silent.mp3'], loop:true, volume:0 });
        primedLoop.play();
      } catch (e) { console.warn('Howler prime failed:', e); }
    }

    function showTapIfNeeded() {
      try {
        if (Howler && Howler.ctx && Howler.ctx.state !== 'running') {
          tapToStart.classList.add('visible');
        }
      } catch {}
    }

    function resumeAudio() {
      try {
        if (Howler && Howler.ctx && Howler.ctx.state !== 'running') {
          Howler.ctx.resume();
        }
      } catch {}
    }

    function resumeAudioOnGesture() {
      resumeAudio();
      tapToStart.classList.remove('visible');
      window.removeEventListener('pointerdown', resumeAudioOnGesture, { once:true });
      window.removeEventListener('keydown', resumeAudioOnGesture, { once:true });
      window.removeEventListener('touchstart', resumeAudioOnGesture, { once:true });
    }
    window.addEventListener('pointerdown', resumeAudioOnGesture, { once:true });
    window.addEventListener('keydown', resumeAudioOnGesture, { once:true });
    window.addEventListener('touchstart', resumeAudioOnGesture, { once:true });
    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible') resumeAudio();
    });

    function HowlerSoundOff(){ if (window.Howler && Howler.volume) { window.isSound = 0; Howler.volume(0); } }
    function HowlerSoundOn(){  if (window.Howler && Howler.volume) { window.isSound = 1; Howler.volume(1); } }
    window.HowlerSoundOff = HowlerSoundOff;
    window.HowlerSoundOn  = HowlerSoundOn;

    window.LoadSound = function(name, src, loopStr, volStr){
      try {
        const loop = loopStr === true || loopStr === 'true';
        const volume = Math.max(0, Math.min(1, parseFloat(volStr || 1)));
        const howl = new Howl({ src: [src], loop, volume });
        window.sounds[name] = howl;
      } catch(e) { console.warn('LoadSound failed', name, src, e); }
    };
    window.PlaySound = function(name){
      try { const h = window.sounds[name]; if (h) { h.play(); window.sound = h; } }
      catch(e) { console.warn('PlaySound failed', name, e); }
    };
    window.StopSound = function(name){
      try { const h = window.sounds[name]; if (h) h.stop(); }
      catch(e) { console.warn('StopSound failed', name, e); }
    };
    window.SetSoundVolume = function(name, volStr){
      try { const h = window.sounds[name]; if (h) h.volume(Math.max(0, Math.min(1, parseFloat(volStr)))); }
      catch(e) { console.warn('SetSoundVolume failed', name, e); }
    };

    window.openUrlInNewTab = function(url){ window.open(url, '_blank'); };
  </script>

  <!-- Your bridge file if needed by your project -->
  <script src="playgama-bridge.js"></script>

  <script>
    // Try to start audio automatically where allowed
    (async function autoStartAudio() {
      const ok = await ensureHowlerReady();
      if (ok) {
        primeAudio();
        // Try resume without gesture. Some browsers will allow it when page is visible.
        setTimeout(resumeAudio, 150);
        showTapIfNeeded();
      }
    })();

    // Unity boot
    (async function bootUnity() {
      // Load Unity loader
      try {
        await new Promise((resolve, reject) => {
          const s = document.createElement('script');
          s.src = 'Build/web.loader.js';
          s.onload = resolve;
          s.onerror = () => reject(new Error('web.loader.js failed to load'));
          document.body.appendChild(s);
        });
      } catch (e) {
        console.error(e.message);
        alert('Oyun yüklenemedi. Lütfen sayfayı yenileyin.');
        return;
      }

      if (typeof createUnityInstance !== 'function') {
        console.error('createUnityInstance is not available.');
        alert('Oyun yüklenemedi. Lütfen sayfayı yenileyin.');
        return;
      }

      try {
        const instance = await createUnityInstance(
          canvas,
          {
            dataUrl: 'Build/web.data.unityweb',
            frameworkUrl: 'Build/web.framework.js.unityweb',
            codeUrl: 'Build/web.wasm.unityweb',
            streamingAssetsUrl: 'StreamingAssets',
            companyName: 'StaticQuasar931',
            productName: 'Brawl Stars',
            productVersion: '1.0'
          },
          onUnityLoadingProgressChanged
        );
        window.unityInstance = instance;
        loadingOverlay.remove();
        canvas.focus();
      } catch (error) {
        console.error('Unity yüklenemedi:', error);
        alert('Oyun yüklenemedi. Lütfen sayfayı yenileyin.');
      }
    })();
  </script>

  <noscript>
    <p style="color:#fff; padding:1rem; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;">
      JavaScript is required to play Brawl Stars.
    </p>
  </noscript>
</body>
</html>
